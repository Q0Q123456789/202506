# è·¯ç”±é…ç½®æ–‡æ¡£

## ğŸ“‹ è·¯ç”±æ¦‚è§ˆ

æœ¬é¡¹ç›®ä½¿ç”¨ Nuxt 3 çš„åŸºäºæ–‡ä»¶çš„è·¯ç”±ç³»ç»Ÿï¼Œæ‰€æœ‰è·¯ç”±éƒ½ç”± `pages/` ç›®å½•ä¸­çš„ Vue æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆã€‚

## ğŸ›£ï¸ è·¯ç”±åˆ—è¡¨

### å…¬å…±è·¯ç”±

| è·¯å¾„ | é¡µé¢æ–‡ä»¶ | æè¿° | å¸ƒå±€ | ä¸­é—´ä»¶ |
|------|----------|------|------|--------|
| `/` | `pages/index.vue` | åº”ç”¨é¦–é¡µ | `default` | `global` |
| `/about` | `pages/about.vue` | å…³äºé¡µé¢ | `default` | `global` |
| `/404` | `pages/404.vue` | 404é”™è¯¯é¡µé¢ | `default` | `global` |

### è®¤è¯ç›¸å…³è·¯ç”±

| è·¯å¾„ | é¡µé¢æ–‡ä»¶ | æè¿° | å¸ƒå±€ | ä¸­é—´ä»¶ |
|------|----------|------|------|--------|
| `/login` | `pages/login.vue` | ç™»å½•/æ³¨å†Œé¡µé¢ | è‡ªå®šä¹‰ | `auth-redirect` |

### å—ä¿æŠ¤è·¯ç”±ï¼ˆéœ€è¦ç™»å½•ï¼‰

| è·¯å¾„ | é¡µé¢æ–‡ä»¶ | æè¿° | å¸ƒå±€ | ä¸­é—´ä»¶ |
|------|----------|------|------|--------|
| `/chat` | `pages/chat.vue` | èŠå¤©å®¤ä¸»é¡µé¢ | è‡ªå®šä¹‰ | `auth`, `global` |
| `/settings` | `pages/settings.vue` | ç”¨æˆ·è®¾ç½®é¡µé¢ | `default` | `auth`, `global` |

### åŠ¨æ€è·¯ç”±

| è·¯å¾„ | é¡µé¢æ–‡ä»¶ | æè¿° | å¸ƒå±€ | ä¸­é—´ä»¶ |
|------|----------|------|------|--------|
| `/user/[username]` | `pages/user/[username].vue` | ç”¨æˆ·èµ„æ–™é¡µé¢ | `default` | `auth`, `global` |

## ğŸ¨ å¸ƒå±€ç³»ç»Ÿ

### é»˜è®¤å¸ƒå±€ (`layouts/default.vue`)

- **ä½¿ç”¨é¡µé¢**: é¦–é¡µã€å…³äºé¡µã€è®¾ç½®é¡µã€404é¡µ
- **ç‰¹æ€§**:
  - å…¨å±€å¯¼èˆªæ 
  - å“åº”å¼èœå•
  - ä¸»é¢˜åˆ‡æ¢ï¼ˆäº®è‰²/æš—è‰²ï¼‰
  - ç”¨æˆ·ä¸‹æ‹‰èœå•
  - é¡µè„šä¿¡æ¯

### è‡ªå®šä¹‰å¸ƒå±€

- **èŠå¤©é¡µé¢**: å®Œå…¨è‡ªå®šä¹‰çš„èŠå¤©ç•Œé¢
- **ç™»å½•é¡µé¢**: ç®€æ´çš„ç™»å½•/æ³¨å†Œè¡¨å•

## ğŸ” è®¤è¯æµç¨‹

### ä¸­é—´ä»¶è¯´æ˜

#### `auth` ä¸­é—´ä»¶ (`middleware/auth.ts`)
- **ä½œç”¨**: ä¿æŠ¤éœ€è¦ç™»å½•çš„é¡µé¢
- **é€»è¾‘**: æ£€æŸ¥è®¤è¯ä»¤ç‰Œï¼Œæœªç™»å½•åˆ™é‡å®šå‘åˆ°ç™»å½•é¡µ

#### `auth-redirect` ä¸­é—´ä»¶ (`middleware/auth-redirect.ts`)
- **ä½œç”¨**: å·²ç™»å½•ç”¨æˆ·è®¿é—®ç™»å½•é¡µæ—¶é‡å®šå‘
- **é€»è¾‘**: å·²ç™»å½•ç”¨æˆ·è®¿é—® `/login` æ—¶é‡å®šå‘åˆ° `/chat`

### è®¤è¯çŠ¶æ€ç®¡ç†

- **å­˜å‚¨**: ä½¿ç”¨ HTTP-only Cookie å­˜å‚¨JWTä»¤ç‰Œ
- **æ£€æŸ¥**: é€šè¿‡ `useCookie('auth-token')` è·å–è®¤è¯çŠ¶æ€
- **æ³¨é”€**: æ¸…é™¤Cookieå¹¶æ–­å¼€WebSocketè¿æ¥

## ğŸ§­ å¯¼èˆªåŠŸèƒ½

### å…¨å±€å¯¼èˆª
- å“ç‰ŒLogoå’Œåç§°é“¾æ¥åˆ°é¦–é¡µ
- ä¸»è¦é¡µé¢å¯¼èˆªé“¾æ¥
- ç”¨æˆ·å¤´åƒå’Œä¸‹æ‹‰èœå•
- ä¸»é¢˜åˆ‡æ¢æŒ‰é’®

### é¡µé¢å†…å¯¼èˆª
- è¿”å›æŒ‰é’®ï¼ˆé¢åŒ…å±‘å¯¼èˆªï¼‰
- é¡µé¢é—´å¿«é€Ÿè·³è½¬é“¾æ¥
- ç”¨æˆ·æ“ä½œèœå•

### å“åº”å¼è®¾è®¡
- ç§»åŠ¨ç«¯è‡ªé€‚åº”å¸ƒå±€
- è§¦æ‘¸å‹å¥½çš„äº¤äº’è®¾è®¡
- æŠ˜å å¼ç§»åŠ¨ç«¯èœå•

## ğŸ”„ è·¯ç”±è·³è½¬

### ç¼–ç¨‹å¼å¯¼èˆª
```javascript
// ä½¿ç”¨ navigateTo
await navigateTo('/chat')

// ä½¿ç”¨ router
await useRouter().push('/settings')
```

### å£°æ˜å¼å¯¼èˆª
```html
<!-- NuxtLink ç»„ä»¶ -->
<NuxtLink to="/about">å…³äºæˆ‘ä»¬</NuxtLink>
<NuxtLink :to="`/user/${userId}`">ç”¨æˆ·èµ„æ–™</NuxtLink>
```

## ğŸš¦ è·¯ç”±å®ˆå«

### é¡µé¢çº§å®ˆå«
```javascript
definePageMeta({
  middleware: 'auth', // åº”ç”¨è®¤è¯ä¸­é—´ä»¶
  layout: 'default',  // æŒ‡å®šå¸ƒå±€
  title: 'é¡µé¢æ ‡é¢˜'
})
```

### åŠ¨æ€è·¯ç”±æ§åˆ¶
- æ ¹æ®ç”¨æˆ·ç™»å½•çŠ¶æ€æ˜¾ç¤ºä¸åŒçš„å¯¼èˆªé€‰é¡¹
- è‡ªåŠ¨é‡å®šå‘é€»è¾‘ï¼ˆé¦–é¡µæ ¹æ®ç™»å½•çŠ¶æ€é‡å®šå‘ï¼‰
- é¡µé¢è®¿é—®æƒé™æ§åˆ¶

## ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–

- å“åº”å¼å¯¼èˆªæ 
- è§¦æ‘¸å‹å¥½çš„æŒ‰é’®å°ºå¯¸
- ç§»åŠ¨ç«¯ä¸“ç”¨çš„èœå•å¸ƒå±€
- ä¼˜åŒ–çš„ç”¨æˆ·äº¤äº’ä½“éªŒ

## ğŸ¯ æœ€ä½³å®è·µ

1. **è·¯ç”±å‘½å**: ä½¿ç”¨è¯­ä¹‰åŒ–çš„æ–‡ä»¶å
2. **å¸ƒå±€é€‰æ‹©**: æ ¹æ®é¡µé¢åŠŸèƒ½é€‰æ‹©åˆé€‚çš„å¸ƒå±€
3. **ä¸­é—´ä»¶ä½¿ç”¨**: ä¸ºéœ€è¦ä¿æŠ¤çš„è·¯ç”±æ·»åŠ è®¤è¯ä¸­é—´ä»¶
4. **å…ƒæ•°æ®**: ä¸ºæ¯ä¸ªé¡µé¢è®¾ç½®é€‚å½“çš„æ ‡é¢˜å’Œæè¿°
5. **é”™è¯¯å¤„ç†**: è‡ªå®šä¹‰404é¡µé¢æå‡ç”¨æˆ·ä½“éªŒ

## ğŸ”§ Nuxt.config.ts è·¯ç”±é…ç½®

### è·¯ç”±é€‰é¡¹
```typescript
router: {
  options: {
    strict: true,        // å¯ç”¨ä¸¥æ ¼æ¨¡å¼è·¯ç”±åŒ¹é…
    trailingSlash: false // ä¸è‡ªåŠ¨æ·»åŠ å°¾éƒ¨æ–œæ 
  }
}
```

### è·¯ç”±è§„åˆ™ (Route Rules)
```typescript
routeRules: {
  // é¢„æ¸²æŸ“å…¬å…±é¡µé¢
  '/': { prerender: true },
  '/about': { prerender: true },
  '/login': { prerender: true },
  
  // å—ä¿æŠ¤è·¯ç”±é‡å®šå‘
  '/chat': { redirect: '/login' },
  '/settings': { redirect: '/login' },
  
  // APIè·¯ç”±é…ç½®
  '/api/**': {
    cors: true,
    headers: {
      'Access-Control-Allow-Methods': 'GET,POST,PUT,DELETE,OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type,Authorization'
    }
  }
}
```

### é¡µé¢è½¬æ¢æ•ˆæœ
```typescript
pageTransition: {
  name: 'page',
  mode: 'out-in'
}

layoutTransition: {
  name: 'layout',
  mode: 'out-in'
}
```

## ğŸ”§ å¼€å‘æç¤º

- æ–°å¢é¡µé¢æ—¶åªéœ€åœ¨ `pages/` ç›®å½•åˆ›å»ºå¯¹åº”çš„ `.vue` æ–‡ä»¶
- ä½¿ç”¨ `definePageMeta()` è®¾ç½®é¡µé¢å…ƒæ•°æ®
- ä¸­é—´ä»¶æ–‡ä»¶æ”¾åœ¨ `middleware/` ç›®å½•
- å¸ƒå±€æ–‡ä»¶æ”¾åœ¨ `layouts/` ç›®å½•
- åŠ¨æ€è·¯ç”±ä½¿ç”¨ `[param].vue` è¯­æ³•
- å…¨å±€ä¸­é—´ä»¶è‡ªåŠ¨åº”ç”¨äºæ‰€æœ‰è·¯ç”±
- è·¯ç”±è§„åˆ™åœ¨ `nuxt.config.ts` ä¸­é…ç½®